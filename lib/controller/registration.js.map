{"version":3,"sources":["../../src/controller/registration.js"],"names":["controller","require","BOT_RESPONSES","hears","bot","message","storage","users","get","user","err","name","reply","startConversation","convo","ask","REGISTRATION_NAME","res","id","team","text","next","REGISTRATION_GITHUB_USERNAME","transcript","gitHubName","save","say","REGISTRATION_FAREWELL","stop"],"mappings":";;AAAA,IAAMA,UAAU,GAAGC,OAAO,CAAC,mBAAD,CAA1B;;AACA,IAAMC,aAAa,GAAGD,OAAO,CAAC,0BAAD,CAA7B;;AAEAD,UAAU,CAACG,KAAX,CACE,CAAC,aAAD,CADF,EAEE,uCAFF,EAGE,UAACC,GAAD,EAAMC,OAAN,EAAkB;AAChBL,EAAAA,UAAU,CAACM,OAAX,CAAmBC,KAAnB,CAAyBC,GAAzB,CAA6BH,OAAO,CAACI,IAArC,EAA2C,UAACC,GAAD,EAAMD,IAAN,EAAe;AACxD,QAAGA,IAAI,IAAIA,IAAI,CAACE,IAAhB,EAAsB;AACpBP,MAAAA,GAAG,CAACQ,KAAJ,CAAUP,OAAV,EAAmB,WAAWI,IAAI,CAACE,IAAhB,GAAuB,gIAA1C;AACD,KAFD,MAEO;AACLP,MAAAA,GAAG,CAACS,iBAAJ,CAAsBR,OAAtB,EAA+B,UAACK,GAAD,EAAMI,KAAN,EAAgB;AAC7C,YAAIL,IAAI,GAAG,EAAX;;AACA,YAAG,CAACC,GAAJ,EAAS;AACPI,UAAAA,KAAK,CAACC,GAAN,CAAUb,aAAa,CAACc,iBAAxB,EAA2C,UAACC,GAAD,EAAMH,KAAN,EAAgB;AACzDL,YAAAA,IAAI,GAAG;AACLS,cAAAA,EAAE,EAAEb,OAAO,CAACI,IADP;AAELU,cAAAA,IAAI,EAAEd,OAAO,CAACe,IAFT;AAGLT,cAAAA,IAAI,EAAEM,GAAG,CAACG;AAHL,aAAP;AAKAN,YAAAA,KAAK,CAACO,IAAN;AACD,WAPD;AAQAP,UAAAA,KAAK,CAACC,GAAN,CACEb,aAAa,CAACoB,4BADhB,EAEE,UAACL,GAAD,EAAMH,KAAN,EAAgB;AAAA,gBACNS,UADM,GACST,KADT,CACNS,UADM;AAEdd,YAAAA,IAAI,CAACe,UAAL,GAAkBD,UAAU,CAAC,CAAD,CAAV,CAAcH,IAAhC;AACApB,YAAAA,UAAU,CAACM,OAAX,CAAmBC,KAAnB,CAAyBkB,IAAzB,CAA8BhB,IAA9B;AACAK,YAAAA,KAAK,CAACO,IAAN;AACD,WAPH;AASAP,UAAAA,KAAK,CAACY,GAAN,CAAUxB,aAAa,CAACyB,qBAAxB,EAA+C,UAACV,GAAD,EAAMH,KAAN,EAAgB;AAC7DA,YAAAA,KAAK,CAACc,IAAN;AACD,WAFD;AAGD;AACF,OAxBD;AAyBD;AACF,GA9BD;AA+BD,CAnCH","sourcesContent":["const controller = require('./spawnController');\nconst BOT_RESPONSES = require('../fixtures/botResponses');\n\ncontroller.hears(\n  ['register me'],\n  'direct_message,direct_mention,mention',\n  (bot, message) => {\n    controller.storage.users.get(message.user, (err, user) => {\n      if(user && user.name) {\n        bot.reply(message, 'Hello ' + user.name + '!! It looks like you\\'ve already registered. Please type \\'edit profile\\' if you\\'d like to make some changes to your profile.');\n      } else {\n        bot.startConversation(message, (err, convo) => {\n          let user = {};\n          if(!err) {\n            convo.ask(BOT_RESPONSES.REGISTRATION_NAME, (res, convo) => {\n              user = {\n                id: message.user,\n                team: message.text,\n                name: res.text\n              };\n              convo.next();\n            });\n            convo.ask(\n              BOT_RESPONSES.REGISTRATION_GITHUB_USERNAME,\n              (res, convo) => {\n                const { transcript } = convo;\n                user.gitHubName = transcript[3].text;\n                controller.storage.users.save(user);\n                convo.next();\n              }\n            );\n            convo.say(BOT_RESPONSES.REGISTRATION_FAREWELL, (res, convo) => {\n              convo.stop();\n            });\n          }\n        });\n      }\n    });\n  }\n);\n"],"file":"registration.js"}